const handleHomeBtnClick=e=>{$(`.home__btnContainer__${e}`).click(()=>{$(".home").fadeOut(()=>{$(`.${e}__step1`).fadeIn(()=>{$(`.${e}__step1`).toggleClass("hidden flex").removeAttr("style")}),setTimeout(()=>{$(".home").toggleClass("flex hidden").removeAttr("style"),$(".returnIcon, .header__msg").removeClass("hidden")},1e3)})})};handleHomeBtnClick("outRequests"),handleHomeBtnClick("inRequests");const socket=io();let day,month,data2send={table:"",values:[],authorFirstName:!0},validationErr=!1;day=(new Date).getDate()<"10"?`0${(new Date).getDate()}`:(new Date).getDate(),month=(new Date).getMonth()<"10"?`0${(new Date).getMonth()+1}`:(new Date).getMonth()+1,$(".outRequests__step1__btn").click(()=>{$(".outRequests__step1").toggleClass("translateXbackwards hidden flex"),setTimeout(()=>{$(".outRequests__step2").fadeIn().removeAttr("style").removeClass("translateXonwards hidden").toggleClass("fixed flex")},1e3)}),$(".outRequests__step2__btn").click(()=>{$(".outRequests__step2").toggleClass("translateXbackwards hidden flex"),setTimeout(()=>{$(".outRequests__step3").fadeIn().removeAttr("style").removeClass("translateXonwards hidden").toggleClass("fixed flex")},1e3)}),$(".returnIcon").click(()=>{const e=e=>{$(e).toggleClass("translateXonwards hidden"),$(".home").toggleClass("hidden flex"),$(".returnIcon, .header__msg").toggleClass("hidden"),setTimeout(()=>{$(e).toggleClass("translateXonwards flex")},500)};$(".outRequests__step1").is(":visible")?e(".outRequests__step1"):$(".outRequests__step2").is(":visible")?($(".outRequests__step2").toggleClass("translateXonwards flex hidden"),$(".outRequests__step1").toggleClass("translateXbackwards hidden flex")):$(".outRequests__step3").is(":visible")?($(".outRequests__step3").toggleClass("translateXonwards flex hidden"),$(".outRequests__step2").toggleClass("translateXbackwards hidden flex")):$(".inRequests__step1").is(":visible")&&e(".inRequests__step1")});$(".inRequests__form__pibInfo__requestDate").val(`${(new Date).getFullYear()}-${month}-${day}`);let barcode=$(".inRequests__form__docInfo__inv");socket.on("barcode",e=>{$(".inRequests__barcode").append(e.code),barcode.val(e.number)});let dataset="#inRequests__form__readerInfo__dataset",readerName=$(".inRequests__form__readerInfo__name");readerName.keyup(()=>{socket.emit("retrieve readers",readerName.val())}),socket.on("readers retrieved",e=>{for(const a of e){$("<option></option").append(a.name).appendTo(dataset)}}),$(readerName).focusout(()=>{$(dataset).empty()}),$(`${dataset} option`).on("click",()=>{$(dataset).empty()}),$(".inRequests__form__btnContainer__submit").click(e=>{e.preventDefault(),data2send.table="in_requests";let a=$(".inRequests__form__pibInfo__pibNb");a.val().match(/\d{6}/)?data2send.values.push(a.val()):invalid(a);let s=$(".inRequests__form__pibInfo__borrowingLibrary");""!==s.val()?data2send.values.push(s.val()):invalid(s);let t=$(".inRequests__form__pibInfo__requestDate");""!==t.val()?data2send.values.push(t.val()):invalid(t);let n=$(".inRequests__form__pibInfo__loanLibrary");""!==n.val()?data2send.values.push(n.val()):invalid(n),""!==readerName.val()?data2send.values.push(readerName.val()):invalid(readerName);let d=$(".inRequests__form__docInfo__title");""!==d.val()?data2send.values.push(d.val()):invalid(d);let _="",i=$(".inRequests__form__docInfo__author");""!==i.val()?-1!==i.val().indexOf(",")?(_=i.val().split(","),data2send.values.push(_[0].toUpperCase().trim(),_[1].trim())):(_=i.val(),data2send.values.push(_),data2send.authorFirstName=!1):invalid(i);let r=$(".inRequests__form__docInfo__cdu");""!==r.val()?data2send.values.push(r.val()):invalid(r);let o=$(".inRequests__form__pibInfo__outProvince").is(":checked");if(data2send.values.push(o),""!==barcode.val()?data2send.values.push(barcode.val()):invalid(barcode.val()),validationErr){if(!$("form .warning").length){$("<span></span>").addClass("warning").text("Certains champs sont incorrects...").appendTo(".inRequests__form")}validationErr=!1,data2send.values=[]}else $(".input").removeClass("invalid"),$("form .warning").hide(),socket.emit("append data",data2send),setTimeout(()=>{$(".inRequests__step3").fadeOut(()=>{$(".inRequests__step3").removeAttr("style").toggleClass("hidden flex"),$(".home").toggleClass("hidden flex"),$(".header__icon, .header__msg").toggleClass("hidden")})},5e3)}),$(".inRequests__form__btnContainer__reset").click(()=>{$(".input").removeClass("invalid"),$("form .warning").hide(),validationErr=!1,data2send.values=[]});const confirmation=()=>{$(".confirmation").toggleClass("hidden flex"),$(".wrapper, .header").toggleClass("blur")},invalid=e=>{e.addClass("invalid"),validationErr=!0};$(".outRequests__form__pibInfo__requestDate").val(`${(new Date).getFullYear()}-${month}-${day}`),$(".outRequests__form__btnContainer__submit").click(e=>{e.preventDefault(),data2send.table="out_requests";let a=$(".outRequests__form__pibInfo__pibNb");a.val().match(/\d{6}/)?data2send.values.push(a.val()):invalid(a);let t=$(".outRequests__form__pibInfo__borrowingLibrary");""!==t.val()?data2send.values.push(t.val()):invalid(t);let s=$(".outRequests__form__pibInfo__requestDate");""!==s.val()?data2send.values.push(s.val()):invalid(s);let n=$(".outRequests__form__pibInfo__loanLibrary");""!==n.val()?data2send.values.push(n.val()):invalid(n);let l=$(".outRequests__form__docInfo__title");""!==l.val()?data2send.values.push(l.val()):invalid(l);let o="",i=$(".outRequests__form__docInfo__author");""!==i.val()?-1!==i.val().indexOf(",")?(o=i.val().split(","),data2send.values.push(o[0].toUpperCase().trim(),o[1].trim())):(o=i.val(),data2send.values.push(o),data2send.authorFirstName=!1):invalid(i);let _=$(".outRequests__form__docInfo__cdu");""!==_.val()?data2send.values.push(_.val()):invalid(_);let d=$(".outRequests__form__pibInfo__outProvince").is(":checked");if(data2send.values.push(d),validationErr){if(!$("form .warning").length){$("<span></span>").addClass("warning").text("Certains champs sont incorrects...").appendTo(".outRequests__form")}validationErr=!1,data2send.values=[]}else $(".input").removeClass("invalid"),$("form .warning").hide(),socket.emit("append data",data2send),confirmation(),setTimeout(()=>{$(".outRequests__step3").fadeOut(()=>{confirmation(),$(".outRequests__step3").removeAttr("style").toggleClass("hidden flex"),$(".home").toggleClass("hidden flex"),$(".header__icon, .header__msg").toggleClass("hidden")})},5e3)}),$(".outRequests__form__btnContainer__reset").click(()=>{$(".input").removeClass("invalid"),$("form .warning").hide(),validationErr=!1,data2send.values=[]});